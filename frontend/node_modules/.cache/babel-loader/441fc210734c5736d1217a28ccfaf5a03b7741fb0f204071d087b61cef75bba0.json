{"ast":null,"code":"import _defineProperty from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Container,Row,Col}from'reactstrap';import'./form.css';import{BASE_URL}from'../utils/config';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UpdateForm(_ref){var tourId=_ref.tourId;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState({title:'',city:'',address:'',distance:'',price:'',maxGroupSize:'',desc:'',photo:null,featured:false}),_useState4=_slicedToArray(_useState3,2),formData=_useState4[0],setFormData=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),objectId=_useState6[0],setObjectId=_useState6[1];useEffect(function(){console.log('Id:',tourId);setObjectId(tourId);var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(BASE_URL,\"/tours/\").concat(tourId));case 3:response=_context.sent;_context.next=6;return response.json();case 6:result=_context.sent;console.log('Retrieved tour:',result);setObjectId(result.data._id);setFormData(result.data);_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error('Error retrieving tour:',_context.t0);window.alert('Oops. Try Again');case 16:case\"end\":return _context.stop();}},_callee,null,[[0,12]]);}));return function fetchData(){return _ref2.apply(this,arguments);};}();if(tourId){fetchData();}},[tourId]);var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value,type=_e$target.type,checked=_e$target.checked;var val=type==='checkbox'?checked:value;setFormData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},name,val));});};function convertToBase64(e){var file=e.target.files[0];var reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(){var base64Result=reader.result;setImage(base64Result);setFormData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{photo:base64Result});});};reader.onerror=function(error){console.error('Error: ',error);};}var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:console.log('update ObjectId:',objectId);_context2.prev=1;_context2.next=4;return fetch(\"\".concat(BASE_URL,\"/tours/\").concat(objectId),{method:'PUT',credentials:'include',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});case 4:response=_context2.sent;_context2.next=7;return response.json();case 7:result=_context2.sent;if(response.ok){_context2.next=10;break;}return _context2.abrupt(\"return\",alert(result.message));case 10:window.alert('Updated Successfully...');window.location.reload();_context2.next=18;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](1);console.error('Error updating tour:',_context2.t0);window.alert('Oops. Try Again');case 18:case\"end\":return _context2.stop();}},_callee2,null,[[1,14]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-main-group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"photo\",onChange:convertToBase64}),formData.photo&&/*#__PURE__*/_jsx(\"img\",{width:100,height:100,src:formData.photo,alt:\"\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",name:\"title\",value:formData.title,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"City\",name:\"city\",value:formData.city,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Address\",name:\"address\",value:formData.address,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Distance\",name:\"distance\",value:formData.distance,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Price\",name:\"price\",value:formData.price,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Max - People\",name:\"maxGroupSize\",value:formData.maxGroupSize,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"textarea\",{name:\"desc\",placeholder:\"Description\",value:formData.desc,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"checkbox-container\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"featured\",children:\"Featured\"}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"featured\",name:\"featured\",checked:formData.featured,onChange:handleChange})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"search__btn\",type:\"button\",onClick:handleUpdate,children:\"Update\"})]})})})})});}export default UpdateForm;","map":{"version":3,"names":["React","useState","useEffect","Container","Row","Col","BASE_URL","UpdateForm","tourId","image","setImage","title","city","address","distance","price","maxGroupSize","desc","photo","featured","formData","setFormData","objectId","setObjectId","console","log","fetchData","fetch","response","json","result","data","_id","error","window","alert","handleChange","e","target","name","value","type","checked","val","prevData","convertToBase64","file","files","reader","FileReader","readAsDataURL","onload","base64Result","onerror","handleUpdate","method","credentials","headers","body","JSON","stringify","ok","message","location","reload"],"sources":["C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/src/Form/UpdateForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, Row, Col } from 'reactstrap';\r\nimport './form.css';\r\nimport { BASE_URL } from '../utils/config';\r\n\r\nfunction UpdateForm({ tourId }) {\r\n  const [image, setImage] = useState('');\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    city: '',\r\n    address: '',\r\n    distance: '',\r\n    price: '',\r\n    maxGroupSize: '',\r\n    desc: '',\r\n    photo: null,\r\n    featured: false,\r\n  });\r\n  const [objectId, setObjectId] = useState('');\r\n\r\n  useEffect(() => {\r\n    console.log('Id:', tourId);\r\n    setObjectId(tourId);\r\n\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await fetch(`${BASE_URL}/tours/${tourId}`);\r\n        const result = await response.json();\r\n        console.log('Retrieved tour:', result);\r\n        setObjectId(result.data._id);\r\n        setFormData(result.data);\r\n      } catch (error) {\r\n        console.error('Error retrieving tour:', error);\r\n        window.alert('Oops. Try Again');\r\n      }\r\n    };\r\n\r\n    if (tourId) {\r\n      fetchData();\r\n    }\r\n  }, [tourId]);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target;\r\n    const val = type === 'checkbox' ? checked : value;\r\n    setFormData((prevData) => ({\r\n      ...prevData,\r\n      [name]: val,\r\n    }));\r\n  };\r\n\r\n  function convertToBase64(e) {\r\n    const file = e.target.files[0];\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      const base64Result = reader.result;\r\n      setImage(base64Result);\r\n      setFormData((prevData) => ({\r\n        ...prevData,\r\n        photo: base64Result,\r\n      }));\r\n    };\r\n    reader.onerror = (error) => {\r\n      console.error('Error: ', error);\r\n    };\r\n  }\r\n\r\n  const handleUpdate = async () => {\r\n    console.log('update ObjectId:', objectId);\r\n\r\n    try {\r\n      const response = await fetch(`${BASE_URL}/tours/${objectId}`, {\r\n        method: 'PUT',\r\n        credentials: 'include',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(formData),\r\n      });\r\n      const result = await response.json();\r\n      if (!response.ok) {\r\n        return alert(result.message);\r\n      }\r\n      window.alert('Updated Successfully...');\r\n      window.location.reload();\r\n    } catch (error) {\r\n      console.error('Error updating tour:', error);\r\n      window.alert('Oops. Try Again');\r\n    }\r\n  };\r\n\r\n  return (\r\n      <Container>\r\n        <Row>\r\n          <Col>\r\n          <form>\r\n      <div className='form-main-group'>\r\n\r\n              <div className=\"form-group\">\r\n                <input type=\"file\" name=\"photo\" onChange={convertToBase64} />\r\n                {formData.photo && <img width={100} height={100} src={formData.photo} alt=\"\" />}\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Title\"\r\n                  name=\"title\"\r\n                  value={formData.title}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"City\"\r\n                  name=\"city\"\r\n                  value={formData.city}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Address\"\r\n                  name=\"address\"\r\n                  value={formData.address}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"Distance\"\r\n                  name=\"distance\"\r\n                  value={formData.distance}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"Price\"\r\n                  name=\"price\"\r\n                  value={formData.price}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"Max - People\"\r\n                  name=\"maxGroupSize\"\r\n                  value={formData.maxGroupSize}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <textarea\r\n                  name=\"desc\"\r\n                  placeholder=\"Description\"\r\n                  value={formData.desc}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n              <div className=\"checkbox-container\">\r\n                <label htmlFor=\"featured\">Featured</label>\r\n                <input type=\"checkbox\" id=\"featured\" name=\"featured\" checked={formData.featured} onChange={handleChange} />\r\n              </div>\r\n              </div>\r\n              <button className='search__btn' type=\"button\" onClick={handleUpdate}>Update</button>\r\n            </div>\r\n            </form>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n  );\r\n}\r\n\r\nexport default UpdateForm;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}