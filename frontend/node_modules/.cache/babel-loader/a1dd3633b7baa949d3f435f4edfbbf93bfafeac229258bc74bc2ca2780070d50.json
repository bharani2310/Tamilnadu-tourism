{"ast":null,"code":"import _toConsumableArray from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{BASE_URL}from'../utils/config';import{Container,Row,Col}from'reactstrap';import useFetch from'../hooks/useFetch';import UpdateForm from\"../Form/UploadForm\";import CreateForm from\"../Form/CreateImage\";import'./table.css';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UploadTable(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),pageCount=_useState2[0],setPageCount=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useFetch=useFetch(\"\".concat(BASE_URL,\"/gallery/getAll?page=\").concat(page)),tours=_useFetch.data,loading=_useFetch.loading,error=_useFetch.error;var _useFetch2=useFetch(\"\".concat(BASE_URL,\"/gallery/search/getGalleryCount\")),galleryCount=_useFetch2.data;useEffect(function(){var pages=Math.ceil(galleryCount/8);setPageCount(pages);window.scrollTo(0,0);},[page,galleryCount]);var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showCreateForm=_useState6[0],setShowCreateForm=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showUpdateForm=_useState8[0],setShowUpdateForm=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selectedTourId=_useState10[0],setSelectedTourId=_useState10[1];var handleCreateClick=function handleCreateClick(){setShowCreateForm(!showCreateForm);};var handleUpdateClick=function handleUpdateClick(tourId){setShowUpdateForm(!showUpdateForm);setSelectedTourId(tourId);};var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(tourId){var confirmDelete,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:confirmDelete=window.confirm('Are you sure you want to delete?');if(!confirmDelete){_context.next=14;break;}_context.prev=2;_context.next=5;return fetch(\"\".concat(BASE_URL,\"/gallery/\").concat(tourId),{method:'DELETE',credentials:'include'});case 5:response=_context.sent;console.log(\"Response : \",response.ok);if(response.ok){window.alert('Gallery Image deleted successfully');window.location.reload();}else{window.alert('Failed to delete tour');}_context.next=12;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);case 12:_context.next=15;break;case 14:window.alert(\"Cancelled Deletion Operation\");case 15:case\"end\":return _context.stop();}},_callee,null,[[2,10]]);}));return function handleDelete(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsxs(Container,{children:[loading&&/*#__PURE__*/_jsx(\"h4\",{className:\"text-center pt-5\",children:\"Loading.......\"}),error&&/*#__PURE__*/_jsx(\"h4\",{className:\"text-center pt-5\",children:error}),!loading&&!error&&/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"table-header\",children:/*#__PURE__*/_jsx(\"button\",{className:\"create\",onClick:handleCreateClick,style:{color:'white'},children:\"Create\"})}),showCreateForm&&/*#__PURE__*/_jsx(\"div\",{className:\"booking__form-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"booking__form\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setShowCreateForm(false);},className:\"close\",children:/*#__PURE__*/_jsx(\"i\",{className:\"ri-close-circle-fill\",style:{fontSize:'2.3rem'}})}),/*#__PURE__*/_jsx(CreateForm,{})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"booking-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Photo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Genre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:tours===null||tours===void 0?void 0:tours.map(function(tour){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"img\",{src:tour.photo,alt:tour.title,style:{width:'100px',height:'auto'}})}),/*#__PURE__*/_jsx(\"td\",{children:tour.title}),/*#__PURE__*/_jsx(\"td\",{children:tour.genre}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn primary__btn\",style:{color:'white',marginRight:'10px'},onClick:function onClick(){return handleUpdateClick(tour._id);},children:\"Edit\"}),showUpdateForm&&selectedTourId===tour._id&&/*#__PURE__*/ // Show UpdateForm only for the selected tour ID\n_jsx(\"div\",{className:\"booking__form-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"booking__form\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setShowUpdateForm(false);},className:\"close\",children:/*#__PURE__*/_jsx(\"i\",{className:\"ri-close-circle-fill\",style:{fontSize:'2.3rem'}})}),/*#__PURE__*/_jsx(UpdateForm,{tourId:selectedTourId})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn danger\",style:{color:'white'},onClick:function onClick(){return handleDelete(tour._id);},children:\"Delete\"})]})]},tour._id);})})]})}),/*#__PURE__*/_jsx(Col,{lg:\"12\"}),/*#__PURE__*/_jsx(Col,{lg:\"12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"pagination d-flex align-items-center justify-content-center mt-4 gap-3\",children:_toConsumableArray(Array(pageCount).keys()).map(function(number){return/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setPage(number);},className:page===number?'active__page':'',children:number+1},number);})})})]})]})})});}export default UploadTable;","map":{"version":3,"names":["React","useState","useEffect","BASE_URL","Container","Row","Col","useFetch","UpdateForm","CreateForm","UploadTable","pageCount","setPageCount","page","setPage","tours","data","loading","error","galleryCount","pages","Math","ceil","window","scrollTo","showCreateForm","setShowCreateForm","showUpdateForm","setShowUpdateForm","selectedTourId","setSelectedTourId","handleCreateClick","handleUpdateClick","tourId","handleDelete","confirmDelete","confirm","fetch","method","credentials","response","console","log","ok","alert","location","reload","color","fontSize","map","tour","photo","title","width","height","genre","marginRight","_id","Array","keys","number"],"sources":["C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/src/Form/UploadTable.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { BASE_URL } from '../utils/config';\r\nimport { Container, Row, Col } from 'reactstrap';\r\nimport useFetch from '../hooks/useFetch'\r\nimport UpdateForm from \"../Form/UploadForm\";\r\nimport CreateForm from \"../Form/CreateImage\";\r\nimport './table.css'\r\n\r\n\r\nfunction UploadTable() {\r\n  const [pageCount, setPageCount] = useState(0);\r\n  const [page, setPage] = useState(0);\r\n\r\n  const { data: tours, loading, error} = useFetch(`${BASE_URL}/gallery/getAll?page=${page}`)\r\n  const { data: galleryCount } = useFetch(`${BASE_URL}/gallery/search/getGalleryCount`)\r\n\r\n  useEffect(() => {\r\n    const pages = Math.ceil(galleryCount / 8)\r\n    setPageCount(pages);\r\n    window.scrollTo(0, 0)\r\n  }, [page, galleryCount]);\r\n\r\n  const [showCreateForm, setShowCreateForm] = useState(false);\r\n  const [showUpdateForm, setShowUpdateForm] = useState(false);\r\n  const [selectedTourId, setSelectedTourId] = useState(null);\r\n\r\n  const handleCreateClick = () => {\r\n    setShowCreateForm(!showCreateForm);\r\n  };\r\n  const handleUpdateClick = (tourId) => {\r\n    setShowUpdateForm(!showUpdateForm);\r\n    setSelectedTourId(tourId);\r\n  };\r\n\r\n\r\n\r\n  const handleDelete = async (tourId) => {\r\n    const confirmDelete = window.confirm('Are you sure you want to delete?');\r\n    if (confirmDelete) {\r\n      try {\r\n        const response = await fetch(`${BASE_URL}/gallery/${tourId}`, {\r\n          method: 'DELETE',\r\n          credentials: 'include',\r\n        });\r\n        console.log(\"Response : \",response.ok);\r\n        if (response.ok) {\r\n          window.alert('Gallery Image deleted successfully');\r\n          window.location.reload();\r\n        } else {\r\n          window.alert('Failed to delete tour');\r\n        }\r\n      } catch (error) {\r\n\r\n      }\r\n    }\r\n    else{\r\n        window.alert(\"Cancelled Deletion Operation\");\r\n    }\r\n    \r\n  };\r\n\r\n  return (\r\n    <>\r\n      <section>\r\n        <Container>\r\n          {loading && <h4 className='text-center pt-5'>Loading.......</h4>}\r\n          {error && <h4 className='text-center pt-5'>{error}</h4>}\r\n          {!loading && !error && (\r\n            <Row>\r\n              <div className=\"table-header\"><button className='create' onClick={handleCreateClick} style={{ color: 'white' }}>Create</button></div>\r\n              {showCreateForm && (\r\n              <div className=\"booking__form-overlay\">\r\n                <div className=\"booking__form\">\r\n                  <button onClick={() => setShowCreateForm(false)} className='close'><i className=\"ri-close-circle-fill\" style={{ fontSize: '2.3rem' }}></i></button>\r\n                  <CreateForm/>\r\n                </div>\r\n              </div>\r\n            )}\r\n              <div className='table-wrapper'>\r\n              <table className='booking-table'>\r\n                <thead>\r\n                  <tr>\r\n                    <th>Photo</th>\r\n                    <th>Title</th>\r\n                    <th>Genre</th>\r\n                    <th>Actions</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {tours?.map((tour) => (\r\n                    <tr key={tour._id}>\r\n                      <td><img src={tour.photo} alt={tour.title} style={{ width: '100px', height: 'auto' }} /></td>\r\n                      <td>{tour.title}</td>\r\n                      <td>{tour.genre}</td>\r\n                      <td>\r\n                      <button className=\"btn primary__btn\" style={{ color: 'white', marginRight: '10px' }} onClick={() => handleUpdateClick(tour._id)}>Edit</button>\r\n                      {showUpdateForm && selectedTourId === tour._id && ( // Show UpdateForm only for the selected tour ID\r\n                        <div className=\"booking__form-overlay\">\r\n                          <div className=\"booking__form\">\r\n                            <button onClick={() => setShowUpdateForm(false)} className='close'><i className=\"ri-close-circle-fill\" style={{ fontSize: '2.3rem' }}></i></button>\r\n                            <UpdateForm tourId={selectedTourId} /> \r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                        <button className=\"btn danger\" style={{ color: 'white' }} onClick={() => handleDelete(tour._id)}>Delete</button>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n              </div>\r\n              <Col lg='12'></Col>\r\n              <Col lg='12'>\r\n                <div className=\"pagination d-flex align-items-center justify-content-center mt-4 gap-3\">\r\n                  {[...Array(pageCount).keys()].map(number => (\r\n                    <span key={number} onClick={() => setPage(number)} className={page === number ? 'active__page' : ''}>\r\n                      {number + 1}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          )}\r\n        </Container>\r\n      </section>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default UploadTable;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}