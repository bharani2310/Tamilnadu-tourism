{"ast":null,"code":"import _defineProperty from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Container,Row,Col}from'reactstrap';import{BASE_URL}from'../utils/config';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UploadForm(_ref){var tourId=_ref.tourId;var genres=['Adventure','Art and Culture','Beaches','Crafts','Cuisine','Festivals','Forts','Hills','Lakes','Monuments','Museum','Palaces','Pilgrim Centers','Places of Interest','Waterfalls','Wellness','Wild Life','Heritage Sites'];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState({photo:null,title:'',genre:''}),_useState4=_slicedToArray(_useState3,2),formData=_useState4[0],setFormData=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),objectId=_useState6[0],setObjectId=_useState6[1];useEffect(function(){console.log('Id:',tourId);setObjectId(tourId);var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(BASE_URL,\"/gallery/images/\").concat(tourId));case 3:response=_context.sent;_context.next=6;return response.json();case 6:result=_context.sent;console.log('Retrieved tour:',result);setObjectId(result.data._id);setFormData(result.data);setImage(result.data.photo);// Set the image state\n_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.error('Error retrieving tour:',_context.t0);window.alert('Oops. Try Again');case 17:case\"end\":return _context.stop();}},_callee,null,[[0,13]]);}));return function fetchData(){return _ref2.apply(this,arguments);};}();if(tourId){fetchData();}},[tourId]);function convertToBase64(e){var file=e.target.files[0];var reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(){var base64Result=reader.result;console.log(base64Result);setImage(base64Result);// Update image state\nsetFormData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{photo:base64Result});});};reader.onerror=function(error){console.log(\"Error: \",error);};}var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setFormData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},name,value));});};var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();console.log(\"Form :\",formData);UploadImage(formData);case 3:case\"end\":return _context2.stop();}},_callee2);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();function UploadImage(_x2){return _UploadImage.apply(this,arguments);}function _UploadImage(){_UploadImage=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(data){var response,result;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:console.log(\"data: \",data);_context3.prev=1;_context3.next=4;return fetch(\"\".concat(BASE_URL,\"/gallery/\").concat(tourId),{method:'PUT',credentials:'include',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});case 4:response=_context3.sent;_context3.next=7;return response.json();case 7:result=_context3.sent;if(response.ok){_context3.next=10;break;}return _context3.abrupt(\"return\",alert(result.message));case 10:window.alert(\"Updated Successfully\");window.location.reload();console.log('Uploaded Image:',result);return _context3.abrupt(\"return\",result);case 16:_context3.prev=16;_context3.t0=_context3[\"catch\"](1);window.alert(\"Oops. Try Again\");console.error('Error Uploading Image:',_context3.t0);throw _context3.t0;case 21:case\"end\":return _context3.stop();}},_callee3,null,[[1,16]]);}));return _UploadImage.apply(this,arguments);}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-main-group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"file-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"photo\",name:\"photo\",onChange:convertToBase64}),image?/*#__PURE__*/_jsx(\"img\",{width:100,height:100,src:image,alt:\"\"}):null]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",name:\"title\",value:formData.title,required:true,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"select\",{name:\"genre\",value:formData.genre,onChange:handleChange,className:\"form-control\",children:genres.map(function(genre,index){return/*#__PURE__*/_jsx(\"option\",{value:genre,children:genre},index);})})}),/*#__PURE__*/_jsx(\"button\",{className:\"search__btn\",onClick:handleSubmit,children:\"Submit\"})]})})})})})});}export default UploadForm;","map":{"version":3,"names":["React","useState","useEffect","Container","Row","Col","BASE_URL","UploadForm","tourId","genres","image","setImage","photo","title","genre","formData","setFormData","objectId","setObjectId","console","log","fetchData","fetch","response","json","result","data","_id","error","window","alert","convertToBase64","e","file","target","files","reader","FileReader","readAsDataURL","onload","base64Result","prevData","onerror","handleChange","name","value","handleSubmit","preventDefault","UploadImage","method","credentials","headers","body","JSON","stringify","ok","message","location","reload","map","index"],"sources":["C:/Users/bhara/OneDrive/Documents/GitHub/TN/Tamilnadu-tourism/frontend/src/Form/UploadForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, Row, Col } from 'reactstrap';\r\nimport { BASE_URL } from '../utils/config';\r\n\r\nfunction UploadForm({ tourId }) {\r\n  const genres = ['Adventure', 'Art and Culture', 'Beaches', 'Crafts', 'Cuisine', 'Festivals', 'Forts', 'Hills', 'Lakes', 'Monuments', 'Museum', 'Palaces', 'Pilgrim Centers', 'Places of Interest', 'Waterfalls', 'Wellness', 'Wild Life', 'Heritage Sites'];\r\n  const [image, setImage] = useState('');\r\n  const [formData, setFormData] = useState({\r\n    photo: null,\r\n    title: '',\r\n    genre: '',\r\n  });\r\n\r\n  const [objectId, setObjectId] = useState('');\r\n\r\n  useEffect(() => {\r\n    console.log('Id:', tourId);\r\n    setObjectId(tourId);\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await fetch(`${BASE_URL}/gallery/images/${tourId}`);\r\n        const result = await response.json();\r\n        console.log('Retrieved tour:', result);\r\n        setObjectId(result.data._id);\r\n        setFormData(result.data);\r\n        setImage(result.data.photo); // Set the image state\r\n      } catch (error) {\r\n        console.error('Error retrieving tour:', error);\r\n        window.alert('Oops. Try Again');\r\n      }\r\n    };\r\n\r\n    if (tourId) {\r\n      fetchData();\r\n    }\r\n  }, [tourId]);\r\n\r\n  function convertToBase64(e) {\r\n    const file = e.target.files[0];\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      const base64Result = reader.result;\r\n      console.log(base64Result);\r\n      setImage(base64Result); // Update image state\r\n      setFormData((prevData) => ({\r\n        ...prevData,\r\n        photo: base64Result,\r\n      }));\r\n    };\r\n    reader.onerror = error => {\r\n      console.log(\"Error: \", error);\r\n    };\r\n  }\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prevData) => ({\r\n      ...prevData,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    console.log(\"Form :\", formData);\r\n    UploadImage(formData);\r\n  };\r\n\r\n  async function UploadImage(data) {\r\n    console.log(\"data: \",data)\r\n    try {\r\n      const response = await fetch(`${BASE_URL}/gallery/${tourId}`, {\r\n        method: 'PUT',\r\n        credentials: 'include',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(data),\r\n      });\r\n      const result = await response.json();\r\n      if (!response.ok) {\r\n        return alert(result.message);\r\n      }\r\n      window.alert(\"Updated Successfully\")\r\n      window.location.reload();\r\n      console.log('Uploaded Image:', result);\r\n      return result;\r\n    } catch (error) {\r\n      window.alert(\"Oops. Try Again\")\r\n      console.error('Error Uploading Image:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Container>\r\n        <Row>\r\n          <Col>\r\n            <form onSubmit={handleSubmit}>\r\n              <div className='form-main-group'>\r\n                <div className=\"file-input-container\">\r\n                  <input type=\"file\" id=\"photo\" name=\"photo\" onChange={convertToBase64} />\r\n                  {image ? <img width={100} height={100} src={image} alt='' /> : null}\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <input type=\"text\" placeholder='Title' name=\"title\" value={formData.title} required onChange={handleChange} />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                  <select name=\"genre\" value={formData.genre} onChange={handleChange} className=\"form-control\">\r\n                    {genres.map((genre, index) => (\r\n                      <option key={index} value={genre}>{genre}</option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                <button className='search__btn' onClick={handleSubmit}>Submit</button>\r\n              </div>\r\n            </form>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default UploadForm;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}